doctype html
html
    head
        title Ios test
    body
        h1 This is the test page
        p: button(id="ios-test") Test island connection

        h3 Output:
        pre(id="output")



script.
    console.log = function(str){
        let output = document.getElementById("output")
        output.innerHTML = output.innerHTML + "\n" + str
    }

    window.onerror = function(msg){

        console.log("UNCAUGHT WINDOW ERROR: " + msg);

    }



    function testWebsocket() {
        try {

            let endpoint = document.location.host
            console.log("Connecting to " + endpoint + "   ...")
            let attempted = 0;
            let connectionAttempts = 7;
            let reconnectionDelay = 5000


            let s = new WebSocket("ws://" + endpoint)



            s.addEventListener('open', function () {
                console.log("Connection established");
            });


            s.onerror = function (err) {

                throw ('Connection Failed');



            }


            s.onmessage = function(msg){
                console.log("MESSAGE: " + msg.toString());
            }




        } catch (err) {
            console.log("!! ERROR: " + err.toString())
        }

    }

    document.getElementById("ios-test").addEventListener("click", testWebsocket)

